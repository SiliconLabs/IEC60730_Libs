<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IEC_60730: Variable Memory Check</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IEC_60730
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Variable Memory Check<div class="ingroups"><a class="el" href="group__efr32__iec60730.html">EFR32 IEC60730 Library</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Verifies RAM is working correctly.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Variable Memory Check:</div>
<div class="dyncontent">
<div class="center"><img src="group__IEC60730__VARIABLE__MEMORY__Test.png" border="0" usemap="#group____IEC60730____VARIABLE____MEMORY____Test" alt=""/></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvmcParams__t.html">vmcParams_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This structure is used as configuration for VMC testing.  <a href="structvmcParams__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gafcf795f5a96fd55561abe69f56224630"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gafcf795f5a96fd55561abe69f56224630">BLOCKSIZE</a>&#160;&#160;&#160;(4)</td></tr>
<tr class="separator:gafcf795f5a96fd55561abe69f56224630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab7a6ab08c9653816bcb906726ec4c625"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gab7a6ab08c9653816bcb906726ec4c625">RT_BLOCK_OVERLAP</a>&#160;&#160;&#160;(1)</td></tr>
<tr class="separator:gab7a6ab08c9653816bcb906726ec4c625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaafe5f5cd2212b1b9c5a1bba0e43dbf16"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gaafe5f5cd2212b1b9c5a1bba0e43dbf16">RT_BLOCKSIZE</a>&#160;&#160;&#160;(<a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gafcf795f5a96fd55561abe69f56224630">BLOCKSIZE</a> + (<a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gab7a6ab08c9653816bcb906726ec4c625">RT_BLOCK_OVERLAP</a> &lt;&lt; 1))</td></tr>
<tr class="separator:gaafe5f5cd2212b1b9c5a1bba0e43dbf16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga850b2f07a67b73890889e63fb8a49fda"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#ga850b2f07a67b73890889e63fb8a49fda">BACKGROUND</a>&#160;&#160;&#160;((uint32_t) 0x00000000uL)</td></tr>
<tr class="separator:ga850b2f07a67b73890889e63fb8a49fda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabf01211bb68ede7a54a60b2f77f899d8"><td class="memItemLeft" align="right" valign="top"><a id="gabf01211bb68ede7a54a60b2f77f899d8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gabf01211bb68ede7a54a60b2f77f899d8">STACK_OVERFLOW_CONST_GUARD_VALUE_0</a>&#160;&#160;&#160;(0xEEEEEEEEuL)</td></tr>
<tr class="memdesc:gabf01211bb68ede7a54a60b2f77f899d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pattern 0 is used for stack overflow. <br /></td></tr>
<tr class="separator:gabf01211bb68ede7a54a60b2f77f899d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4ca7fe9616c171c577e60df3afd35d4c"><td class="memItemLeft" align="right" valign="top"><a id="ga4ca7fe9616c171c577e60df3afd35d4c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#ga4ca7fe9616c171c577e60df3afd35d4c">STACK_OVERFLOW_CONST_GUARD_VALUE_1</a>&#160;&#160;&#160;(0xCCCCCCCCuL)</td></tr>
<tr class="memdesc:ga4ca7fe9616c171c577e60df3afd35d4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pattern 1 is used for stack overflow. <br /></td></tr>
<tr class="separator:ga4ca7fe9616c171c577e60df3afd35d4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga62b63b5f7a13c9323f91477ecec6aba1"><td class="memItemLeft" align="right" valign="top"><a id="ga62b63b5f7a13c9323f91477ecec6aba1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#ga62b63b5f7a13c9323f91477ecec6aba1">STACK_OVERFLOW_CONST_GUARD_VALUE_2</a>&#160;&#160;&#160;(0xBBBBBBBBuL)</td></tr>
<tr class="memdesc:ga62b63b5f7a13c9323f91477ecec6aba1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pattern 2 is used for stack overflow. <br /></td></tr>
<tr class="separator:ga62b63b5f7a13c9323f91477ecec6aba1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga75a78ca5e999345b5e082c1695e97582"><td class="memItemLeft" align="right" valign="top"><a id="ga75a78ca5e999345b5e082c1695e97582"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#ga75a78ca5e999345b5e082c1695e97582">STACK_OVERFLOW_CONST_GUARD_VALUE_3</a>&#160;&#160;&#160;(0xDDDDDDDDuL)</td></tr>
<tr class="memdesc:ga75a78ca5e999345b5e082c1695e97582"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pattern 3 is used for stack overflow. <br /></td></tr>
<tr class="separator:ga75a78ca5e999345b5e082c1695e97582"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0ccdba6dafc3ea84329974483e1c1d64"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#ga0ccdba6dafc3ea84329974483e1c1d64">__STACK_BOTTOM</a>&#160;&#160;&#160;__attribute__((section(&quot;.stack_bottom&quot;)))</td></tr>
<tr class="separator:ga0ccdba6dafc3ea84329974483e1c1d64"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gacfc27fdace9baad090a08676443030e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gacfc27fdace9baad090a08676443030e0">iec60730_VmcInit</a> (<a class="el" href="structvmcParams__t.html">vmcParams_t</a> *params)</td></tr>
<tr class="separator:gacfc27fdace9baad090a08676443030e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga22773c2c382079a11115ba53b64b8df8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741">iec60730_TestResult_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#ga22773c2c382079a11115ba53b64b8df8">iec60730_VmcPost</a> (<a class="el" href="structvmcParams__t.html">vmcParams_t</a> *params)</td></tr>
<tr class="separator:ga22773c2c382079a11115ba53b64b8df8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf10bd8e32c2e1487d09764e6d76a5eed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741">iec60730_TestResult_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gaf10bd8e32c2e1487d09764e6d76a5eed">iec60730_VmcBist</a> (<a class="el" href="structvmcParams__t.html">vmcParams_t</a> *params)</td></tr>
<tr class="separator:gaf10bd8e32c2e1487d09764e6d76a5eed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Verifies RAM is working correctly. </p>
<h1><a class="anchor" id="vmc_hardware_architecture"></a>
Hardware Architecture</h1>
<p>Depending on using the definitation, the testing process takes place through different steps and different region RAM memory.</p>
<h1><a class="anchor" id="vmc_failure_risks"></a>
Failure Risks</h1>
<p>There are several potential sources of failure in the variable memory hardware</p><ul>
<li>Stuck bits that do not change (either 0 or 1)</li>
<li>Coupled bits that change based on a neighbor</li>
<li>Address lines that couple or disconnect, activating an incorrect location</li>
<li>Single Event Upset (SEU) that toggle a bit or bits without permanent damage to the memory hardware</li>
</ul>
<p>The variable memory check can detect the first three types of errors using the March-X algorithm. The VMC is based on a word-oriented March-X algorithm from <a href="http://www.ece.uc.edu/~wjone/Memory.pdf">http://www.ece.uc.edu/~wjone/Memory.pdf</a>.</p>
<p>SEU failures are not detected in a class B control, and would require class C level of validation to detect - data duplication, error- detecting-and-correcting memory, etc. A failure of this type will be detected once it causes a secondary failure such as missing a watchdog restart or incorrect clock frequency.</p>
<h1><a class="anchor" id="vmc_software_architecture"></a>
Software Architecture</h1>
<p>As show in <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#vmc_software_architecture">Software Architecture</a>, there are 3 test processes happen. In the case POST testing, the algorithm used is March-C. In the BIST testing, the algorithm used is March-X by default. If user DOES NOT use the #USE_MARCHX definition, the algorithm used is March-C. March-X algorithm is faster than March-C because March-X algorithm is only March-C algorithm that omits some steps (Step 3, 4). The March-C algorithm (van de Goor,1991) is described as below steps</p>
<ul>
<li>STEP 1: Write all zeros to array</li>
<li>STEP 2: Starting at lowest address, read zeros, write ones, increment up array</li>
<li>STEP 3: Starting at lowest address, read ones, write zeros, increment up array.</li>
<li>STEP 4: Starting at highest address, read zeros, write ones, decrement down array.</li>
<li>STEP 5: Starting at highest address, read ones, write zeros, decrement down array.</li>
<li>STEP 6: Read all zeros from array.</li>
</ul>
<p>Some detail about implementing of Variable Memory Check (VMC) and used variables. These ariables are also used in the test cases (TC) of the VMC module.</p>
<p>To make sure the VMC module as well as the IMC module work properly, it is necessary to ensure the location of the ram area for these modules. The sections SHOULD be placed in the correct order: (*.rt_buf*) -&gt; (*.overlap*). DO NOT change this order. Please refer to our example linker for more details.</p>
<p>User need declare a variable of struct <a class="el" href="structvmcParams__t.html" title="This structure is used as configuration for VMC testing.">vmcParams_t</a>. In the initialization step, We need to assign the start address and end address to this variable for executing the VMC. We will call the starting address #RAMTEST_START and the ending address #RAMTEST_END to make it easier to describe later.</p>
<p><a class="anchor" id="bkBuf"></a></p><ul>
<li>Variable <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#bkBuf">bkBuf</a> is a buffer used to backup data during testing process and is placed at (*.rt_buf*) section. The size of this variable is defined in #IEC_BOARD_HEADER (i.e <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gaafe5f5cd2212b1b9c5a1bba0e43dbf16">RT_BLOCKSIZE</a> definition). The <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gaafe5f5cd2212b1b9c5a1bba0e43dbf16">RT_BLOCKSIZE</a> definition will be mentioned later.</li>
</ul>
<p><a class="anchor" id="ramTestOverLap"></a></p><ul>
<li>Variable <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#ramTestOverLap">ramTestOverLap</a> is a buffer used to ensure that the algorithm runs at <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gaf10bd8e32c2e1487d09764e6d76a5eed">iec60730_VmcBist</a> function is correct. This variable is placed at (*.overlap*) section.</li>
</ul>
<p><a class="anchor" id="rtCheck"></a></p><ul>
<li>Variable <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#rtCheck">rtCheck</a> is pointer that point to start address of testing process and is placed at (*.classb_ram*) section. In case <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#rtCheck">rtCheck</a> is less than #RAMTEST_END, every time function <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gaf10bd8e32c2e1487d09764e6d76a5eed">iec60730_VmcBist</a> is invoked and test is done, then the value of <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#rtCheck">rtCheck</a> increases by <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gafcf795f5a96fd55561abe69f56224630">BLOCKSIZE</a>. The <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gafcf795f5a96fd55561abe69f56224630">BLOCKSIZE</a> definition is defined in #IEC_BOARD_HEADER and will be mentioned later. Otherwise, we test the backup buffer (i.e the bkBuf variable is mentioned above).</li>
</ul>
<p>Before performing the RAM test, we provide a callback function named #Vmc_PreRunMarchXC_Step. After performing the RAM test, we also provide a callback function named #Vmc_PostRunMarchXC_Step, and the user decides what to do after the RAM test is over.</p>
<p>As mentioned about #IEC_BOARD_HEADER in <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html">Invariable Memory Check</a> module, the definition #IEC_BOARD_HEADER also has the necessary information for VMC module to run. The #RAMTEST_START and #RAMTEST_END definitions are used to assigned to start, and end member of a variable of type <a class="el" href="structvmcParams__t.html" title="This structure is used as configuration for VMC testing.">vmcParams_t</a>. Two definitions are optional because the user can directly assign values to the start and end member of a variable as long as these values satisfy the conditions describled of the #RAMTEST_START, and #RAMTEST_END definitions. The <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#ga850b2f07a67b73890889e63fb8a49fda">BACKGROUND</a>, <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gafcf795f5a96fd55561abe69f56224630">BLOCKSIZE</a>, <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gab7a6ab08c9653816bcb906726ec4c625">RT_BLOCK_OVERLAP</a>, and <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gaafe5f5cd2212b1b9c5a1bba0e43dbf16">RT_BLOCKSIZE</a> SHOULD use our default definitions.</p>
<p>Currently we also support stack test to check for stack overflow using pattern (here is an array with 4 elements) placed at the bottom of the stack. You can refer to the (*.stack_bottom*) section in our linker example. The initialization values of this array are initialized when calling the function <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gacfc27fdace9baad090a08676443030e0">iec60730_VmcInit</a>. Every time when executing <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gaf10bd8e32c2e1487d09764e6d76a5eed">iec60730_VmcBist</a> will check the value of this array and based on the check results will return <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a26db973cd4fdebd964685ce701486450" title="test result failed">iec60730_TestFailed</a> nor not.</p>
<p><a class="anchor" id="stackTestOverFlow"></a></p><ul>
<li>Variable <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#stackTestOverFlow">stackTestOverFlow</a> is buffer that store values defined by <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gabf01211bb68ede7a54a60b2f77f899d8" title="Pattern 0 is used for stack overflow.">STACK_OVERFLOW_CONST_GUARD_VALUE_0</a>, <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#ga4ca7fe9616c171c577e60df3afd35d4c" title="Pattern 1 is used for stack overflow.">STACK_OVERFLOW_CONST_GUARD_VALUE_1</a>, <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#ga62b63b5f7a13c9323f91477ecec6aba1" title="Pattern 2 is used for stack overflow.">STACK_OVERFLOW_CONST_GUARD_VALUE_2</a>, and <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#ga75a78ca5e999345b5e082c1695e97582" title="Pattern 3 is used for stack overflow.">STACK_OVERFLOW_CONST_GUARD_VALUE_3</a>.</li>
</ul>
<p><a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#ga22773c2c382079a11115ba53b64b8df8">iec60730_VmcPost()</a></p>
<p><a class="anchor" id="variable_memory_check_post_flowchart"></a></p><div class="image">
<img src="variable_memory_check_post_flowchart.png" alt=""/>
<div class="caption">
Figure 1 Flow chart of Variable Memory Check POST</div></div>
<p><a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gaf10bd8e32c2e1487d09764e6d76a5eed">iec60730_VmcBist()</a></p>
<p><a class="anchor" id="variable_memory_check_bist_flowchart"></a></p><div class="image">
<img src="variable_memory_check_bist_flowchart.png" alt=""/>
<div class="caption">
Figure 2 Flow chart of Variable Memory Check BIST</div></div>
<p>Figure 3 shows two examples of RAM configurations. The figure on the left can be found in our examples. The figure on the right is a possible scenario. We will analyze these cases as below.</p>
<p><a class="anchor" id="variable_memory_check_example_flowchart"></a></p><div class="image">
<img src="variable_memory_check_example_flowchart.png" alt=""/>
<div class="caption">
Figure 3 Example of RAM memory configuration</div></div>
<p>With the figure on the left, as mentioned above (*.rt_buf*) and (*.overlap*) are placed in fixed order, namely <b>Ram Backup</b> and <b>Overlap</b> as shown in the Figure. The #RAMTEST_START can start the next Overlap. This figure also describes the algorithm of testing. The RAM area under test is defined starting from #RAMTEST_START to #RAMTEST_END, and split into multiple BLOCKs. Each block has a size determined by <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gafcf795f5a96fd55561abe69f56224630">BLOCKSIZE</a>. In the first test step, the BLOCK (1) and <b>Overlap</b> are tested. The <b>Ram Backup</b> is used to back up the data in the BLOCK being tested, and will restore it after the test in BLOCKs competletey. In the second test step, BLOCK (2) is tested and a part of BLOCK (1) is also tested. There is an area in BLOCK (1), also called overlap, which will be tested twice. This makes the test even more secure. Continue like this until the test reaches BLOCK (N), the last block, then return to test the <b>Ram Backup</b>.</p>
<p>The image on the right is slightly different when, the tested area (from #RAMTEST_START to #RAMTEST_END) contains <b>RamBackup</b> and <b>Overlap</b>. In order to ensure the algorithm works properly, in the case like the figure on the right at the starting position (#RAMTEST_START) it is necessary to create an overlap area. As mentioned above this overlap is also tested so user DOES NOT need to worry. Next, the test process is the same as said, will test the BLOCKs (from BLOCK (1) to BLOCK (N)). Here is a point to note when testing to <b>Ram Backup</b>, it will be ignored because this <b>Ram Backup</b> WILL be tested after the test of the last block (BLOCK (N)).</p>
<p>In case the tested area has the address of #RAMTEST_START smaller than the address of <b>RamBackup</b>, the test process is similar to the figure on the right. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga0ccdba6dafc3ea84329974483e1c1d64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0ccdba6dafc3ea84329974483e1c1d64">&#9670;&nbsp;</a></span>__STACK_BOTTOM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __STACK_BOTTOM&#160;&#160;&#160;__attribute__((section(&quot;.stack_bottom&quot;)))</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#ga0ccdba6dafc3ea84329974483e1c1d64">__STACK_BOTTOM</a> macro is used to define (.stack_bottom) section. </p>

</div>
</div>
<a id="ga850b2f07a67b73890889e63fb8a49fda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga850b2f07a67b73890889e63fb8a49fda">&#9670;&nbsp;</a></span>BACKGROUND</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BACKGROUND&#160;&#160;&#160;((uint32_t) 0x00000000uL)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#ga850b2f07a67b73890889e63fb8a49fda">BACKGROUND</a> definition is background used to testing. In our sample, value 0x00000000uL is used value for background. Of course, we can define another value. We recommend using definition like ours (0x00000000uL) because it accurately describes the steps of the March-X/March-C algorithm described above. </p>

</div>
</div>
<a id="gafcf795f5a96fd55561abe69f56224630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafcf795f5a96fd55561abe69f56224630">&#9670;&nbsp;</a></span>BLOCKSIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BLOCKSIZE&#160;&#160;&#160;(4)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gafcf795f5a96fd55561abe69f56224630">BLOCKSIZE</a> definition MUST be 4 as our example for the algorithm to work properly. </p>

</div>
</div>
<a id="gab7a6ab08c9653816bcb906726ec4c625"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab7a6ab08c9653816bcb906726ec4c625">&#9670;&nbsp;</a></span>RT_BLOCK_OVERLAP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RT_BLOCK_OVERLAP&#160;&#160;&#160;(1)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gab7a6ab08c9653816bcb906726ec4c625">RT_BLOCK_OVERLAP</a> definition is used to present the size of #ramTestOverLap buffer. The variable #ramTestOverLap has a size of (2 * <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gab7a6ab08c9653816bcb906726ec4c625">RT_BLOCK_OVERLAP</a>). For the algorithm (March-X/March-C) to work properly this definition MUST take the value 1 as in our example. </p>

</div>
</div>
<a id="gaafe5f5cd2212b1b9c5a1bba0e43dbf16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaafe5f5cd2212b1b9c5a1bba0e43dbf16">&#9670;&nbsp;</a></span>RT_BLOCKSIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RT_BLOCKSIZE&#160;&#160;&#160;(<a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gafcf795f5a96fd55561abe69f56224630">BLOCKSIZE</a> + (<a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gab7a6ab08c9653816bcb906726ec4c625">RT_BLOCK_OVERLAP</a> &lt;&lt; 1))</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The definition of <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gaafe5f5cd2212b1b9c5a1bba0e43dbf16">RT_BLOCKSIZE</a> is taken from the definition of <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gafcf795f5a96fd55561abe69f56224630">BLOCKSIZE</a> and <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gab7a6ab08c9653816bcb906726ec4c625">RT_BLOCK_OVERLAP</a>. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaf10bd8e32c2e1487d09764e6d76a5eed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf10bd8e32c2e1487d09764e6d76a5eed">&#9670;&nbsp;</a></span>iec60730_VmcBist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741">iec60730_TestResult_t</a> iec60730_VmcBist </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvmcParams__t.html">vmcParams_t</a> *&#160;</td>
          <td class="paramname"><em>params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>public IEC60730 Variable Memory Check (VMC) BIST</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>input parameter of struct <a class="el" href="structvmcParams__t.html" title="This structure is used as configuration for VMC testing.">vmcParams_t</a> form</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741" title="The result of a test.">iec60730_TestResult_t</a>.<ul>
<li>If test fails, return <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a26db973cd4fdebd964685ce701486450" title="test result failed">iec60730_TestFailed</a>;</li>
<li>If not complete, returns <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a60b3c9c488facdb917c35ffca92960f9" title="test is still in progress">iec60730_TestInProgress</a></li>
<li>Otherwise, returns <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a6796830621fbae14b5c78b4a36af1b84" title="test result passed">iec60730_TestPassed</a>.</li>
</ul>
</dd></dl>
<p>Performs a variable memory check in defined area. For details how <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gaf10bd8e32c2e1487d09764e6d76a5eed">iec60730_VmcBist</a> work, please refer to <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#vmc_software_architecture">Software Architecture</a></p>
<p>Requires <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gacfc27fdace9baad090a08676443030e0">iec60730_VmcInit</a> to be called first to setup global variables. </p>

</div>
</div>
<a id="gacfc27fdace9baad090a08676443030e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacfc27fdace9baad090a08676443030e0">&#9670;&nbsp;</a></span>iec60730_VmcInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iec60730_VmcInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvmcParams__t.html">vmcParams_t</a> *&#160;</td>
          <td class="paramname"><em>params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>public IEC60730 Variable Memory Check (VMC) Initialize</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>input parameter of struct <a class="el" href="structvmcParams__t.html" title="This structure is used as configuration for VMC testing.">vmcParams_t</a> form</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<p>Performs a initialization of global variables. This function SHOULD call before calling <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gaf10bd8e32c2e1487d09764e6d76a5eed">iec60730_VmcBist</a> </p>

</div>
</div>
<a id="ga22773c2c382079a11115ba53b64b8df8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga22773c2c382079a11115ba53b64b8df8">&#9670;&nbsp;</a></span>iec60730_VmcPost()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741">iec60730_TestResult_t</a> iec60730_VmcPost </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvmcParams__t.html">vmcParams_t</a> *&#160;</td>
          <td class="paramname"><em>params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>public IEC60730 Variable Memory Check (VMC) POST</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>input parameter of struct <a class="el" href="structvmcParams__t.html" title="This structure is used as configuration for VMC testing.">vmcParams_t</a> form</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741" title="The result of a test.">iec60730_TestResult_t</a>.<ul>
<li>If test fails, returns <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a26db973cd4fdebd964685ce701486450" title="test result failed">iec60730_TestFailed</a></li>
<li>Otherwise, returns <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a6796830621fbae14b5c78b4a36af1b84" title="test result passed">iec60730_TestPassed</a>.</li>
</ul>
</dd></dl>
<p>Performs a variable memory check in defined area. For details how <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#gaf10bd8e32c2e1487d09764e6d76a5eed">iec60730_VmcBist</a> work, please refer to <a class="el" href="group__IEC60730__VARIABLE__MEMORY__Test.html#vmc_software_architecture">Software Architecture</a> </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
