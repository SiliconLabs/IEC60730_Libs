name: Generate Firmware
on: 
  push:

env:
  TOOL_DIRS: /home/sqa/SimplicityStudio_v5/developer/toolchains/gnu_arm/12.2.rel1_2023.7/bin
  SDK_PATH: /home/sqa/SimplicityStudio/SDKs/gecko_sdk
  TOOL_CHAINS: GCC
  START_ADDR_FLASH: 0x8000000
jobs:
  job1:
    name: Generate Firmware
    runs-on: ubuntu-20.04
    permissions:
      contents: read
      pull-requests: write
    env: 
      HOST_IP: 192.168.1.69
      COMPILER: GCC
      PLATFORM: MG12
      APP_TYPE: SecureApp
      SECURITY: APP_SECURE=false
      COMMAND: all
      COMPONENT: all
    steps:
    - name: Checkout
      uses: actions/checkout@v4.1.7
    - name: Generate Firmware
      run: |
        export TOOL_DIRS=/home/sqa/SimplicityStudio_v5/developer/toolchains/gnu_arm/10.3_2021.10/bin
        export SDK_PATH=/home/sqa/SimplicityStudio/SDKs/gecko_sdk
        export TOOL_CHAINS=GCC
        export START_ADDR_FLASH=0x8000000
        export PATH="/home/sqa/slc_cli/:$PATH"
        slc trust --sdk $SDK_PATH
        slc configuration -gcc=$TOOL_DIRS
        pwd
        ls -la
        chmod -R 777 . 
        cd Test/
        ls -la
        ./generate_fw.sh $COMMAND $COMPONENT $PLATFORM $COMPILER $SECURITY
    - name: Upload artifact
      uses: actions/upload-artifact@v4.3.4
      with:
        name: firmware
        path: artifact
        warn: Output a warning but do not fail the action
        retention-days: 90

    
  
  
          
