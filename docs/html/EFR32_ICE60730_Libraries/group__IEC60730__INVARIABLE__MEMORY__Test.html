<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IEC_60730: Invariable Memory Check</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IEC_60730
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Invariable Memory Check<div class="ingroups"><a class="el" href="group__efr32__sl_iec60730.html">EFR32 IEC60730 Library</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Verifies contents of flash memory.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Invariable Memory Check:</div>
<div class="dyncontent">
<div class="center"><img src="group__IEC60730__INVARIABLE__MEMORY__Test.png" border="0" usemap="#group____IEC60730____INVARIABLE____MEMORY____Test" alt=""/></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structimcParams__t.html">imcParams_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This structure is used as configuration for IMC testing, that holds GPCRC Register.  <a href="structimcParams__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structupdateCrcParams__t.html">updateCrcParams_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga6dba447a327f1cb1da83327a4e7abb80"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga6dba447a327f1cb1da83327a4e7abb80">FLASH_BLOCK</a>&#160;&#160;&#160;(64)</td></tr>
<tr class="separator:ga6dba447a327f1cb1da83327a4e7abb80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1fafdaede51f1a2092840264d1776522"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga1fafdaede51f1a2092840264d1776522">ROM_END</a>&#160;&#160;&#160;((uint32_t *) (&amp;<a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a>))</td></tr>
<tr class="separator:ga1fafdaede51f1a2092840264d1776522"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad9e53d1418399b36953a40395ac1384d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gad9e53d1418399b36953a40395ac1384d">ROM_SIZE</a>&#160;&#160;&#160;((uint32_t) <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga1fafdaede51f1a2092840264d1776522">ROM_END</a> - (uint32_t) ROM_START)</td></tr>
<tr class="separator:gad9e53d1418399b36953a40395ac1384d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1756482c5c8ec4b8e3a2635e3cac8778"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga1756482c5c8ec4b8e3a2635e3cac8778">STEPS_NUMBER</a>&#160;&#160;&#160;((uint32_t) <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gad9e53d1418399b36953a40395ac1384d">ROM_SIZE</a> / <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga6dba447a327f1cb1da83327a4e7abb80">FLASH_BLOCK</a>)</td></tr>
<tr class="separator:ga1756482c5c8ec4b8e3a2635e3cac8778"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga31d3955f55968c7f8dee5682092847b1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga31d3955f55968c7f8dee5682092847b1">ROM_SIZE_INWORDS</a>&#160;&#160;&#160;((uint32_t) <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gad9e53d1418399b36953a40395ac1384d">ROM_SIZE</a> / 4U)</td></tr>
<tr class="separator:ga31d3955f55968c7f8dee5682092847b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9ab72a2f0d6a9c3bc531b69362b202a1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga9ab72a2f0d6a9c3bc531b69362b202a1">FLASH_BLOCK_WORDS</a>&#160;&#160;&#160;((uint32_t) (<a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga31d3955f55968c7f8dee5682092847b1">ROM_SIZE_INWORDS</a> / <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga1756482c5c8ec4b8e3a2635e3cac8778">STEPS_NUMBER</a>))</td></tr>
<tr class="separator:ga9ab72a2f0d6a9c3bc531b69362b202a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac8a3e47f009f04f9dfdee367c0507f22"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gac8a3e47f009f04f9dfdee367c0507f22">REF_CRC</a>&#160;&#160;&#160;(<a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a>)</td></tr>
<tr class="separator:gac8a3e47f009f04f9dfdee367c0507f22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga156dbd14b4ce248fe9c88819982a7a5d"><td class="memItemLeft" align="right" valign="top"><a id="ga156dbd14b4ce248fe9c88819982a7a5d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DEFAULT_GPRC</b>&#160;&#160;&#160;GPCRC</td></tr>
<tr class="separator:ga156dbd14b4ce248fe9c88819982a7a5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga558de50fe1c89a1afb8292d2ee4346da"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga558de50fe1c89a1afb8292d2ee4346da">IMC_CRCBUFFER_SAMPLETEST</a>&#160;&#160;&#160;&quot;123456789&quot;</td></tr>
<tr class="separator:ga558de50fe1c89a1afb8292d2ee4346da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gace0835e825dfeca0c043ef08af67d9e4"><td class="memItemLeft" align="right" valign="top"><a id="gace0835e825dfeca0c043ef08af67d9e4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IMC_CRCBUFFER_INIT_VALUE</b>&#160;&#160;&#160;(0xFFFF)</td></tr>
<tr class="separator:gace0835e825dfeca0c043ef08af67d9e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9c3356b134655aec941235118b70fae9"><td class="memItemLeft" align="right" valign="top"><a id="ga9c3356b134655aec941235118b70fae9"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IMC_CRCBUFFER_XOROUTPUT</b>&#160;&#160;&#160;(0x0000)</td></tr>
<tr class="separator:ga9c3356b134655aec941235118b70fae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9ccd80b391104e8c4c07e02de05b80cc"><td class="memItemLeft" align="right" valign="top"><a id="ga9ccd80b391104e8c4c07e02de05b80cc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IMC_CRCBUFFER_SAMPLERESULT</b>&#160;&#160;&#160;(0x29B1)</td></tr>
<tr class="separator:ga9ccd80b391104e8c4c07e02de05b80cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3921ff9a1a6850b76e609667f2cb30c3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>IMC_CRCBUFFER_INIT_DEFAULT</b></td></tr>
<tr class="separator:ga3921ff9a1a6850b76e609667f2cb30c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7d44834c1dcf3032838d3d68945da3b4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>IMC_CRCBUFFER_UPDATE_DEFAULT</b></td></tr>
<tr class="separator:ga7d44834c1dcf3032838d3d68945da3b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4c93088feb3d474585b60b5b55cb4c8b"><td class="memItemLeft" align="right" valign="top"><a id="ga4c93088feb3d474585b60b5b55cb4c8b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IMC_INIT_VALUE</b>&#160;&#160;&#160;(0x0000)</td></tr>
<tr class="separator:ga4c93088feb3d474585b60b5b55cb4c8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga34b3f43d5d8d5f660d8c997191b89e29"><td class="memItemLeft" align="right" valign="top"><a id="ga34b3f43d5d8d5f660d8c997191b89e29"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IMC_XOROUTPUT</b>&#160;&#160;&#160;(0x0000)</td></tr>
<tr class="separator:ga34b3f43d5d8d5f660d8c997191b89e29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0b447f793221b8ee07831792b00cb511"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>IMC_INIT_DEFAULT</b></td></tr>
<tr class="separator:ga0b447f793221b8ee07831792b00cb511"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga6b6c21dae2994d1cc6afc120b32719bf"><td class="memItemLeft" align="right" valign="top"><a id="ga6b6c21dae2994d1cc6afc120b32719bf"></a>
typedef uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>crc_t</b></td></tr>
<tr class="separator:ga6b6c21dae2994d1cc6afc120b32719bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga26f1499161354923417472c57fd0f942"><td class="memItemLeft" align="right" valign="top"><a id="ga26f1499161354923417472c57fd0f942"></a>
typedef uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga26f1499161354923417472c57fd0f942">readType_t</a></td></tr>
<tr class="memdesc:ga26f1499161354923417472c57fd0f942"><td class="mdescLeft">&#160;</td><td class="mdescRight">The way to read CRC value when using function <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gabdc62d310b78ec8e9f011cb28c6b9225">iec60730_updateCRCWithDataBuffer</a>. <br /></td></tr>
<tr class="separator:ga26f1499161354923417472c57fd0f942"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga06fc87d81c62e9abb8790b6e5713c55b"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gga06fc87d81c62e9abb8790b6e5713c55ba81e9d30c093158a799c13cf1d42df28a">IMC_DATA_READ</a> = 0, 
<a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gga06fc87d81c62e9abb8790b6e5713c55ba14b98b0e584e8059ab9e3990ffe8e149">IMC_DATA_READ_BIT_REVERSED</a>, 
<a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gga06fc87d81c62e9abb8790b6e5713c55ba641228c714e8ef6fb667f3ee76761f22">IMC_DATA_READ_BYTE_REVERSED</a>
 }</td></tr>
<tr class="separator:ga06fc87d81c62e9abb8790b6e5713c55b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa655a39e13c235af64c9c1a65798eda5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gaa655a39e13c235af64c9c1a65798eda5">iec60730_ImcInit</a> (<a class="el" href="structimcParams__t.html">imcParams_t</a> *params)</td></tr>
<tr class="separator:gaa655a39e13c235af64c9c1a65798eda5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabdc62d310b78ec8e9f011cb28c6b9225"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741">iec60730_TestResult_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gabdc62d310b78ec8e9f011cb28c6b9225">iec60730_updateCRCWithDataBuffer</a> (<a class="el" href="structupdateCrcParams__t.html">updateCrcParams_t</a> *params, crc_t *crc, uint8_t *buffer, uint32_t size)</td></tr>
<tr class="separator:gabdc62d310b78ec8e9f011cb28c6b9225"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga137fdbab6da48afed3c5120ff18a1a3d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741">iec60730_TestResult_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga137fdbab6da48afed3c5120ff18a1a3d">iec60730_ImcPost</a> (<a class="el" href="structimcParams__t.html">imcParams_t</a> *params)</td></tr>
<tr class="separator:ga137fdbab6da48afed3c5120ff18a1a3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5a2c4e133b3741d068369405320070c6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741">iec60730_TestResult_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga5a2c4e133b3741d068369405320070c6">iec60730_ImcBist</a> (<a class="el" href="structimcParams__t.html">imcParams_t</a> *params)</td></tr>
<tr class="separator:ga5a2c4e133b3741d068369405320070c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga958cd3e171526a901e3c8b99cf2dfd56"><td class="memItemLeft" align="right" valign="top">crc_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a></td></tr>
<tr class="separator:ga958cd3e171526a901e3c8b99cf2dfd56"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Verifies contents of flash memory. </p>
<h1><a class="anchor" id="imc_hardware_architecture"></a>
Hardware Architecture</h1>
<p>In the current version, the calculation of CRC for Flash is calculated starting from the starting address of the Flash (that value can be changed) to the end address whose value is specified by the address of the <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a> variable. Currently, the <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a> variable is set to the end address of user code that uses IEC Library.</p>
<p>To test the Flash memory, a Cyclic Redundancy Check (CRC) is computed and compared with a value stored in Flash. Any change in the Flash will cause the CRC not to match the stored value.</p>
<p>We support multiple calculation modes. These modes are selected by the user. User adds definitions to use these modes. Please reference to definitions #CRC_DEBUG, #CRC_USE_SW, and #USE_CRC_32 for more detail.</p>
<h1><a class="anchor" id="imc_failure_risks"></a>
Failure Risks</h1>
<p>As electrically eraseable memories, the primary risk with Flash is losing charge. Normal memory concerns such as stuck-at, coupling, and address faults may also occur. All these faults will be detected by a CRC across the region. Another risk is the hardware CRC module operating incorrectly. In this case, the CRC comparison will fail and <a class="el" href="group__IEC60730__SAFE__STATE.html#gaf28ccd1df36222150296fbfe62ace9cf">iec60730_SafeState()</a> will begin.</p>
<h1><a class="anchor" id="imc_software_architecture"></a>
Software Architecture</h1>
<p>The Invariable Memory Check (IMC) validates that the Flash memory storing the firmware and any persistent configuration information has not been corrupted. The IMC calculates a CRC across designated areas to verify their contents.</p>
<p>We support calculation CRC by using hardware and software. The default CRC is hardware calculation. User CAN use the #CRC_USE_SW definition in case using CRC software.</p>
<p>With case CRC software is chosen, the default is calculate CRC-table in initialization process. User CAN use the #SW_CRC_TABLE definition in case using pre-defined table.</p>
<p>We support both CRC-16 and CRC-32 mode. With CRC-16, the CRC engine is configured to use the CRC-16/XMODEM polynominal 0x1021. With CRC-32, the CRC engine is configured to use the CRC-32 polynominal 0x04C11DB7. The default is CRC-16 mode. In case using CRC-32, user SHOULD define the #USE_CRC_32 definition.</p>
<p>We also provide scripts named gcc_crc16.sh (for CRC-16 mode) and gcc_crc32.sh (for CRC-32 mode) which is used in Post Build process to calculate CRC value of the Flash and place this CRC value at the end of user code determined by address of <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a> variable. We WILL call these scripts with the common name <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gcc_crcXY">gcc_crcXY</a>. Don't worry about the gcc prefix, these scripts work for both GCC and IAR compiler. To use these scripts, user SHOULD install srecord that can be downloaded (.exe) file for Window OS or run command as below for Linux OS.</p>
<div class="fragment"><div class="line">$sudo apt install srecord</div>
</div><!-- fragment --><p><a class="anchor" id="gcc_crcXY"></a>Script <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gcc_crcXY">gcc_crcXY</a> requires the following parameters </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"></td><td class="paramname">$1</td><td>Name of your project. </td></tr>
    <tr><td class="paramtype"></td><td class="paramname">$2</td><td>Directory of building. This directory MUST contain *.hex file and *.map file. The *.map file MUST contains <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a> variable. </td></tr>
    <tr><td class="paramtype"></td><td class="paramname">$3</td><td>Path of srecord. With Linux OS, it SHOULD be blank. With Win OS, it SHOULD be the path to install folder of srecord. For example: 'C:\srecord-1.64-win32' in Win OS. </td></tr>
    <tr><td class="paramtype"></td><td class="paramname">$4</td><td>Compiler: GCC or IAR. </td></tr>
    <tr><td class="paramtype"></td><td class="paramname">$5</td><td>Start address of Flash. </td></tr>
    <tr><td class="paramtype"></td><td class="paramname">$6</td><td>True for non-secure. False otherwise.</td></tr>
  </table>
  </dd>
</dl>
<p>The struct <a class="el" href="structimcParams__t.html" title="This structure is used as configuration for IMC testing, that holds GPCRC Register.">imcParams_t</a> is used to manage hardware configuration of CRC. In case using CRC software (define #CRC_USE_SW), you can pass NULL pointer to function use this struct.</p>
<p>We use a pair of variables to check intergrity. Using the following macros in case you want to work with pair of variables need to be checked intergrity. These macros are defined in <a class="el" href="iec60730_8h.html" title="Library definitions.">sl_iec60730.h</a> file.</p>
<ul>
<li><a class="el" href="group__IEC60730__POST.html#ga8b1f082b1b96f93a3325897446c18128">DEC_CLASSB_VARS</a> is used to declare a pair of variables.</li>
<li><a class="el" href="group__IEC60730__POST.html#ga3facba7fb5e30c4dc4f1733910b309a2">EXTERN_DEC_CLASSB_VARS</a> is used to mark pair of variable to be extern.</li>
<li><a class="el" href="group__IEC60730__POST.html#ga6c276c6c39755499927558bd8067b18f">sl_static_dec_classb_vars</a> is used to declare a static pair of variables.</li>
<li><a class="el" href="group__IEC60730__POST.html#ga7ceff82eebbc7dd125727947508df7ea">INV_CLASSB_VAR</a> is used to inverse value of a variable.</li>
<li><a class="el" href="group__IEC60730__POST.html#ga5e516d9dd091357c8ecb7ba3c10c7f9b">INV_CLASSB_PVAR</a> is used to inverse value of a pointer.</li>
</ul>
<p>Some detail about implementing of IMC and using variables for testing purpose. These ariables are also used in the test cases (TC) of the IMC module.</p>
<p><a class="anchor" id="refCrc"></a></p><ul>
<li>Variable <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#refCrc">refCrc</a> is variable that is stored on (*.classb_ram*) section. In case user use definition #CRC_DEBUG for debug purpose, <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#refCrc">refCrc</a> variable is useful for debug purpose. Value of <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#refCrc">refCrc</a> is calculated in <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga137fdbab6da48afed3c5120ff18a1a3d">iec60730_ImcPost</a> function. This value SHOULD be equal value that stored in address of <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a>.</li>
</ul>
<p><a class="anchor" id="curCrc"></a></p><ul>
<li>Variable <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#curCrc">curCrc</a> is variable that stores on (*.classb_ram*) section. This variable is CRC calculated value after each function call <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga5a2c4e133b3741d068369405320070c6">iec60730_ImcBist</a>. That means this value will be accumulated for each step of BIST. After checking all Flash, the final value of <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#curCrc">curCrc</a> under normal conditions, no exception SHOULD be equal to the value stored in Flash.</li>
</ul>
<p><a class="anchor" id="runCrc"></a></p><ul>
<li>Variable <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#runCrc">runCrc</a> is variable that stores on (*.classb_ram*) section. This is pointer that point to start address of testing process. In case <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#runCrc">runCrc</a> is less than <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga1fafdaede51f1a2092840264d1776522">ROM_END</a>, every time function <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga5a2c4e133b3741d068369405320070c6">iec60730_ImcBist</a> is invoked, the value of <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#runCrc">runCrc</a> increases by <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga9ab72a2f0d6a9c3bc531b69362b202a1">FLASH_BLOCK_WORDS</a>. Otherwise, calculating <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#curCrc">curCrc</a> and compare it with value of <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#refCrc">refCrc</a> or value stored in <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gac8a3e47f009f04f9dfdee367c0507f22">REF_CRC</a>.</li>
</ul>
<p>To provide complete definitions of IMC modules, in #IEC_BOARD_HEADER file, user SHOULD pay attention to the #ROM_START definition. The <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga1756482c5c8ec4b8e3a2635e3cac8778">STEPS_NUMBER</a>, <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga31d3955f55968c7f8dee5682092847b1">ROM_SIZE_INWORDS</a>, and <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga9ab72a2f0d6a9c3bc531b69362b202a1">FLASH_BLOCK_WORDS</a> definitions SHOULD use our default definitions. The <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga6dba447a327f1cb1da83327a4e7abb80">FLASH_BLOCK</a>, <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga1fafdaede51f1a2092840264d1776522">ROM_END</a>, and <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gac8a3e47f009f04f9dfdee367c0507f22">REF_CRC</a> definitions can be redefined by the user but SHOULD not be recommended unless the user has knowledge of linker and Flash configuration.</p>
<p>Figure 1 describes a Flash with multiple applications on that. These applications are named Application 1, Application 2, ..., Application N, and Application (N+1). Where Application N is a main application that uses the IEC library.</p>
<p><a class="anchor" id="invariable_memory_check_example_flowchart"></a></p><div class="image">
<img src="invariable_memory_check_example_flowchart.png" alt=""/>
<div class="caption">
Figure 1 Example of calculating CRC</div></div>
<p>The #ROM_START definition can be placed anywhere that guarantees the description of #ROM_START. As you can see in Figure 1, it is possible that #ROM_START is either #ROM_START (1) or #ROM_START (N).</p>
<p>The <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga1fafdaede51f1a2092840264d1776522">ROM_END</a> definition as described at the address of the variable <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a>. As the linker files is used in our example will be at address the end of Application (N). The CRC calculation will go from address #ROM_START to <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga1fafdaede51f1a2092840264d1776522">ROM_END</a>.</p>
<p>With #ROM_START (1) we calculate CRC (1) and with #ROM_START (N) we calculate CRC (N). The CRC value is calculated and placed at the location of the variable <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a>. Calculating and placing are implemented by script <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gcc_crcXY">gcc_crcXY</a>.</p>
<p>In this example you see that Application (N + 1) is an application that does not use the IEC library. Our reference solutions DO NOT support customizing <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a> anywhere in Flash. Therefore, the CRC calculation WILL not cover the Flash area of Application (N + 1).</p>
<p>In case the user edits their linker to let the <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a> variable go to any location (of course larger than #ROM_START), the IMC modules WILL still work normally. For example, the user adjust the address of <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a> to the end address of Flash of Application (N + 1), then the CRC calculation WILL completely cover Application (N + 1).</p>
<p>Function <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga137fdbab6da48afed3c5120ff18a1a3d">iec60730_ImcPost()</a> checks for all the invariable memory areas have been configured.</p>
<p>On BIST, partial memory sections are tested to keep overall BIST test time reasonable. Global variables store the current location being tested and other information. Each call to <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga5a2c4e133b3741d068369405320070c6">iec60730_ImcBist()</a> it checks #INVAR_BLOCKS_PER_BIST. If after the calculation, the CRC does not match the expected value <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a26db973cd4fdebd964685ce701486450" title="test result failed">iec60730_TestFailed</a> is returned. If it does match, the global variables are configured for the next CRC entry. If all areas are complete, <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a6796830621fbae14b5c78b4a36af1b84" title="test result passed">iec60730_TestPassed</a> is returned. If all areas are not complete, <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a60b3c9c488facdb917c35ffca92960f9" title="test is still in progress">iec60730_TestInProgress</a> is returned.</p>
<p><a class="anchor" id="invariable_memory_check_post_flowchart"></a></p><div class="image">
<img src="invariable_memory_check_post_flowchart.png" alt=""/>
<div class="caption">
Figure 2 Flow chart of Invariable Memory Check BIST&amp;POST</div></div>
 <h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga6dba447a327f1cb1da83327a4e7abb80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6dba447a327f1cb1da83327a4e7abb80">&#9670;&nbsp;</a></span>FLASH_BLOCK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_BLOCK&#160;&#160;&#160;(64)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga6dba447a327f1cb1da83327a4e7abb80">FLASH_BLOCK</a> definition is size of block of Flash. The value of this definition SHOULD be a power of two. The minimal value SHOULD be 4 and maximum value SHOULD be the alignment value that is defined in linker (GCC compiler) or in configuration of IAR. Our example use alignment 64 for <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a> variable. So that in our example the <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga6dba447a327f1cb1da83327a4e7abb80">FLASH_BLOCK</a> definition is 64. User can refer to our example linker on how to provide <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a> variable with alignment 64. </p>

</div>
</div>
<a id="ga9ab72a2f0d6a9c3bc531b69362b202a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9ab72a2f0d6a9c3bc531b69362b202a1">&#9670;&nbsp;</a></span>FLASH_BLOCK_WORDS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_BLOCK_WORDS&#160;&#160;&#160;((uint32_t) (<a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga31d3955f55968c7f8dee5682092847b1">ROM_SIZE_INWORDS</a> / <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga1756482c5c8ec4b8e3a2635e3cac8778">STEPS_NUMBER</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga9ab72a2f0d6a9c3bc531b69362b202a1">FLASH_BLOCK_WORDS</a> definitionn WILL be defined base on <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga31d3955f55968c7f8dee5682092847b1">ROM_SIZE_INWORDS</a> and <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga1756482c5c8ec4b8e3a2635e3cac8778">STEPS_NUMBER</a> definitions. User SHOULD not change it. </p>

</div>
</div>
<a id="ga3921ff9a1a6850b76e609667f2cb30c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3921ff9a1a6850b76e609667f2cb30c3">&#9670;&nbsp;</a></span>IMC_CRCBUFFER_INIT_DEFAULT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMC_CRCBUFFER_INIT_DEFAULT</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  {                                                                            \</div>
<div class="line">      0x1021UL,                                                                \</div>
<div class="line">      IMC_CRCBUFFER_INIT_VALUE,                                                \</div>
<div class="line">      false,                                                                   \</div>
<div class="line">      true,                                                                    \</div>
<div class="line">      false,                                                                   \</div>
<div class="line">      false,                                                                   \</div>
<div class="line">      true,                                                                    \</div>
<div class="line">  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga558de50fe1c89a1afb8292d2ee4346da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga558de50fe1c89a1afb8292d2ee4346da">&#9670;&nbsp;</a></span>IMC_CRCBUFFER_SAMPLETEST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMC_CRCBUFFER_SAMPLETEST&#160;&#160;&#160;&quot;123456789&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This macro is the sample test buffer used for testing CRC algorithm. This value is used in development phase. User DOES NOT take care this definition. </p>

</div>
</div>
<a id="ga7d44834c1dcf3032838d3d68945da3b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7d44834c1dcf3032838d3d68945da3b4">&#9670;&nbsp;</a></span>IMC_CRCBUFFER_UPDATE_DEFAULT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMC_CRCBUFFER_UPDATE_DEFAULT</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  {{DEFAULT_GPRC},                                                             \</div>
<div class="line">   IMC_CRCBUFFER_INIT_DEFAULT,                                                 \</div>
<div class="line">   IMC_DATA_READ_BIT_REVERSED,                                                 \</div>
<div class="line">   IMC_CRCBUFFER_XOROUTPUT}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga0b447f793221b8ee07831792b00cb511"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0b447f793221b8ee07831792b00cb511">&#9670;&nbsp;</a></span>IMC_INIT_DEFAULT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMC_INIT_DEFAULT</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  {                                                                            \</div>
<div class="line">      0x1021UL,                                                                \</div>
<div class="line">      IMC_INIT_VALUE,                                                          \</div>
<div class="line">      false,                                                                   \</div>
<div class="line">      true,                                                                    \</div>
<div class="line">      false,                                                                   \</div>
<div class="line">      false,                                                                   \</div>
<div class="line">      true,                                                                    \</div>
<div class="line">  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="gac8a3e47f009f04f9dfdee367c0507f22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac8a3e47f009f04f9dfdee367c0507f22">&#9670;&nbsp;</a></span>REF_CRC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REF_CRC&#160;&#160;&#160;(<a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gac8a3e47f009f04f9dfdee367c0507f22">REF_CRC</a> definition describes variable that address of this variable store CRC value that is calculated by <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gcc_crcXY">gcc_crcXY</a> in Post Build. We use <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a> so in our example <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gac8a3e47f009f04f9dfdee367c0507f22">REF_CRC</a> definition is <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a>. </p>

</div>
</div>
<a id="ga1fafdaede51f1a2092840264d1776522"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1fafdaede51f1a2092840264d1776522">&#9670;&nbsp;</a></span>ROM_END</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ROM_END&#160;&#160;&#160;((uint32_t *) (&amp;<a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga1fafdaede51f1a2092840264d1776522">ROM_END</a> definition describes the end address of Flash. It is the address of <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a> variables. In this version, users SHOULD not change this definition. Refer to the example in <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#invariable_memory_check_example_flowchart">invariable_memory_check_example_flowchart</a>, to better understand the #ROM_START, and <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga1fafdaede51f1a2092840264d1776522">ROM_END</a> definitions. </p>

</div>
</div>
<a id="gad9e53d1418399b36953a40395ac1384d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad9e53d1418399b36953a40395ac1384d">&#9670;&nbsp;</a></span>ROM_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ROM_SIZE&#160;&#160;&#160;((uint32_t) <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga1fafdaede51f1a2092840264d1776522">ROM_END</a> - (uint32_t) ROM_START)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gad9e53d1418399b36953a40395ac1384d">ROM_SIZE</a> definition describes the size of Flash calculated CRC value. This calculation based on <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga1fafdaede51f1a2092840264d1776522">ROM_END</a>, and #ROM_START definitions. </p>

</div>
</div>
<a id="ga31d3955f55968c7f8dee5682092847b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga31d3955f55968c7f8dee5682092847b1">&#9670;&nbsp;</a></span>ROM_SIZE_INWORDS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ROM_SIZE_INWORDS&#160;&#160;&#160;((uint32_t) <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gad9e53d1418399b36953a40395ac1384d">ROM_SIZE</a> / 4U)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga31d3955f55968c7f8dee5682092847b1">ROM_SIZE_INWORDS</a> definitionn WILL be defined base on <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gad9e53d1418399b36953a40395ac1384d">ROM_SIZE</a> definition. User SHOULD not change it. </p>

</div>
</div>
<a id="ga1756482c5c8ec4b8e3a2635e3cac8778"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1756482c5c8ec4b8e3a2635e3cac8778">&#9670;&nbsp;</a></span>STEPS_NUMBER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STEPS_NUMBER&#160;&#160;&#160;((uint32_t) <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gad9e53d1418399b36953a40395ac1384d">ROM_SIZE</a> / <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga6dba447a327f1cb1da83327a4e7abb80">FLASH_BLOCK</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga1756482c5c8ec4b8e3a2635e3cac8778">STEPS_NUMBER</a> definitionn WILL be defined base on <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gad9e53d1418399b36953a40395ac1384d">ROM_SIZE</a> and <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga6dba447a327f1cb1da83327a4e7abb80">FLASH_BLOCK</a> definition. User SHOULD not change it. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga06fc87d81c62e9abb8790b6e5713c55b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga06fc87d81c62e9abb8790b6e5713c55b">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga06fc87d81c62e9abb8790b6e5713c55ba81e9d30c093158a799c13cf1d42df28a"></a>IMC_DATA_READ&#160;</td><td class="fielddoc"><p>use function GPCRC_DataRead to read CRC </p>
</td></tr>
<tr><td class="fieldname"><a id="gga06fc87d81c62e9abb8790b6e5713c55ba14b98b0e584e8059ab9e3990ffe8e149"></a>IMC_DATA_READ_BIT_REVERSED&#160;</td><td class="fielddoc"><p>use function GPCRC_DataReadBitReversed to read CRC </p>
</td></tr>
<tr><td class="fieldname"><a id="gga06fc87d81c62e9abb8790b6e5713c55ba641228c714e8ef6fb667f3ee76761f22"></a>IMC_DATA_READ_BYTE_REVERSED&#160;</td><td class="fielddoc"><p>use function GPCRC_DataReadByteReversed to read CRC </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga5a2c4e133b3741d068369405320070c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5a2c4e133b3741d068369405320070c6">&#9670;&nbsp;</a></span>iec60730_ImcBist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741">iec60730_TestResult_t</a> iec60730_ImcBist </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structimcParams__t.html">imcParams_t</a> *&#160;</td>
          <td class="paramname"><em>params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>public IEC60730 Invariable Memory Check BIST</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>input parameter of struct <a class="el" href="structimcParams__t.html" title="This structure is used as configuration for IMC testing, that holds GPCRC Register.">imcParams_t</a> form</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741" title="The result of a test.">iec60730_TestResult_t</a>.<ul>
<li>If test fails, return <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a26db973cd4fdebd964685ce701486450" title="test result failed">iec60730_TestFailed</a>;</li>
<li>Else if not complete, return <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a60b3c9c488facdb917c35ffca92960f9" title="test is still in progress">iec60730_TestInProgress</a></li>
<li>Otherwise, return <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a6796830621fbae14b5c78b4a36af1b84" title="test result passed">iec60730_TestPassed</a>.</li>
</ul>
</dd></dl>
<p>Performs a CRC check across all defined memory areas. For details how <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga5a2c4e133b3741d068369405320070c6">iec60730_ImcBist</a> work, please refer to <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#imc_software_architecture">Software Architecture</a></p>
<p>Requires <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#gaa655a39e13c235af64c9c1a65798eda5">iec60730_ImcInit</a> to be called first to setup global variables. </p>

</div>
</div>
<a id="gaa655a39e13c235af64c9c1a65798eda5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa655a39e13c235af64c9c1a65798eda5">&#9670;&nbsp;</a></span>iec60730_ImcInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iec60730_ImcInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structimcParams__t.html">imcParams_t</a> *&#160;</td>
          <td class="paramname"><em>params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>public IEC60730 Invariable Memory Check (IMC) Init</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>input parameter of struct <a class="el" href="structimcParams__t.html" title="This structure is used as configuration for IMC testing, that holds GPCRC Register.">imcParams_t</a> form</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<p>Performs a initialization of global variables and hardware configuration in case hardware support. </p>

</div>
</div>
<a id="ga137fdbab6da48afed3c5120ff18a1a3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga137fdbab6da48afed3c5120ff18a1a3d">&#9670;&nbsp;</a></span>iec60730_ImcPost()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741">iec60730_TestResult_t</a> iec60730_ImcPost </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structimcParams__t.html">imcParams_t</a> *&#160;</td>
          <td class="paramname"><em>params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>public IEC60730 Invariable Memory Check POST</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>input parameter of struct <a class="el" href="structimcParams__t.html" title="This structure is used as configuration for IMC testing, that holds GPCRC Register.">imcParams_t</a> form</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741" title="The result of a test.">iec60730_TestResult_t</a>.<ul>
<li>If test fails, returns <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a26db973cd4fdebd964685ce701486450" title="test result failed">iec60730_TestFailed</a>;</li>
<li>Otherwise, return <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a6796830621fbae14b5c78b4a36af1b84" title="test result passed">iec60730_TestPassed</a>.</li>
</ul>
</dd></dl>
<p>Performs a CRC check across all defined memory areas. </p>

</div>
</div>
<a id="gabdc62d310b78ec8e9f011cb28c6b9225"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabdc62d310b78ec8e9f011cb28c6b9225">&#9670;&nbsp;</a></span>iec60730_updateCRCWithDataBuffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741">iec60730_TestResult_t</a> iec60730_updateCRCWithDataBuffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structupdateCrcParams__t.html">updateCrcParams_t</a> *&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">crc_t *&#160;</td>
          <td class="paramname"><em>crc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>public IEC60730 Update CRC git pull with Data Buffer</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>input parameter of struct <a class="el" href="structupdateCrcParams__t.html">updateCrcParams_t</a> form </td></tr>
    <tr><td class="paramname">crc</td><td>The CRC to be updated. The initial value of crc is also initial value of CRC calculation. </td></tr>
    <tr><td class="paramname">buffer</td><td>A contiguous array of 1-byte values to be used to update the CRC. </td></tr>
    <tr><td class="paramname">size</td><td>The number of bytes stored in the buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741" title="The result of a test.">iec60730_TestResult_t</a>.<ul>
<li>If test fails, returns <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a26db973cd4fdebd964685ce701486450" title="test result failed">iec60730_TestFailed</a>;</li>
<li>Otherwise, return <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a6796830621fbae14b5c78b4a36af1b84" title="test result passed">iec60730_TestPassed</a>.</li>
</ul>
</dd></dl>
<p>This routine takes a CRC and updates it using a buffer of one or more bytes of data. For details on the CRC polynomial used, see <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#imc_hardware_architecture">Hardware Architecture</a> </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ga958cd3e171526a901e3c8b99cf2dfd56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga958cd3e171526a901e3c8b99cf2dfd56">&#9670;&nbsp;</a></span>check_sum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">crc_t check_sum</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The end address of Flash is specified by the address of the <a class="el" href="group__IEC60730__INVARIABLE__MEMORY__Test.html#ga958cd3e171526a901e3c8b99cf2dfd56">check_sum</a> variable. This variable is provided by linker in GCC or generated by configurations in IAR. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
