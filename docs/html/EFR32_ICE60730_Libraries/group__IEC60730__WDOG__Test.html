<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IEC_60730: Watchdog Test</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IEC_60730
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Watchdog Test<div class="ingroups"><a class="el" href="group__efr32__sl_iec60730.html">EFR32 IEC60730 Library</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Monitors CPU execution.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Watchdog Test:</div>
<div class="dyncontent">
<div class="center"><img src="group__IEC60730__WDOG__Test.png" border="0" usemap="#group____IEC60730____WDOG____Test" alt=""/></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiec60730__WatchDog__t.html">iec60730_WatchDog_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Watchdog component configuration structure.  <a href="structiec60730__WatchDog__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga6cdc39974698fca5e429f9c2fd74e086"><td class="memItemLeft" align="right" valign="top"><a id="ga6cdc39974698fca5e429f9c2fd74e086"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_WDOGINST_NUMB</b>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ga6cdc39974698fca5e429f9c2fd74e086"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf0d95208bf6d8d64b4d11acdb8177517"><td class="memItemLeft" align="right" valign="top"><a id="gaf0d95208bf6d8d64b4d11acdb8177517"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_ENABLE_WDOG0</b></td></tr>
<tr class="separator:gaf0d95208bf6d8d64b4d11acdb8177517"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga94c74339aef9ae6121281031f9d2905a"><td class="memItemLeft" align="right" valign="top"><a id="ga94c74339aef9ae6121281031f9d2905a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_WDOG_WAIT_TIMEOUT</b>&#160;&#160;&#160;(uint32_t) 0x0000FFFFUL</td></tr>
<tr class="separator:ga94c74339aef9ae6121281031f9d2905a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9b9ea237b837cef20891f8dca51c3735"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>WDG_INST_DEF</b>()</td></tr>
<tr class="separator:ga9b9ea237b837cef20891f8dca51c3735"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga76236e377be6459c92bf09f1b2c9cab9"><td class="memItemLeft" align="right" valign="top"><a id="ga76236e377be6459c92bf09f1b2c9cab9"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_WDOG</b>(numb)&#160;&#160;&#160;iec60730_WdogInst_arr[numb].wdog</td></tr>
<tr class="separator:ga76236e377be6459c92bf09f1b2c9cab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1c086b62801f08ba01ee7b1c6221292e"><td class="memItemLeft" align="right" valign="top"><a id="ga1c086b62801f08ba01ee7b1c6221292e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_WDOG_INST</b>(n)&#160;&#160;&#160;WDOG##n</td></tr>
<tr class="separator:ga1c086b62801f08ba01ee7b1c6221292e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga69124f6223238c4ff08dfa1ff06f9c1b"><td class="memItemLeft" align="right" valign="top"><a id="ga69124f6223238c4ff08dfa1ff06f9c1b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_RST</b>&#160;&#160;&#160;RMU</td></tr>
<tr class="separator:ga69124f6223238c4ff08dfa1ff06f9c1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga246f57c48c6fc3de37a098e7b7014af2"><td class="memItemLeft" align="right" valign="top"><a id="ga246f57c48c6fc3de37a098e7b7014af2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_RSTCAUSE_POR</b>&#160;&#160;&#160;RMU_RSTCAUSE_PORST</td></tr>
<tr class="separator:ga246f57c48c6fc3de37a098e7b7014af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga536e1af0e7624cd0b548bfbd876481c0"><td class="memItemLeft" align="right" valign="top"><a id="ga536e1af0e7624cd0b548bfbd876481c0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_RSTCAUSE_EM4</b>&#160;&#160;&#160;RMU_RSTCAUSE_EM4RST</td></tr>
<tr class="separator:ga536e1af0e7624cd0b548bfbd876481c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9beeefb3ec6a9fcac35b35e0f91bb2ae"><td class="memItemLeft" align="right" valign="top"><a id="ga9beeefb3ec6a9fcac35b35e0f91bb2ae"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_RSTCAUSE_WDOG0</b>&#160;&#160;&#160;RMU_RSTCAUSE_WDOGRST</td></tr>
<tr class="separator:ga9beeefb3ec6a9fcac35b35e0f91bb2ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9cc7671d6b1ec2511c5c78035bc36987"><td class="memItemLeft" align="right" valign="top"><a id="ga9cc7671d6b1ec2511c5c78035bc36987"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_RSTCAUSE_WDOG1</b>&#160;&#160;&#160;RMU_RSTCAUSE_WDOGRST</td></tr>
<tr class="separator:ga9cc7671d6b1ec2511c5c78035bc36987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad156ac33ab4d946d158f7faafff358e8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_RSTCAUSES_CLEAR</b>()</td></tr>
<tr class="separator:gad156ac33ab4d946d158f7faafff358e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga92150a1d7898e89e46c6fbac95ea60d3"><td class="memItemLeft" align="right" valign="top"><a id="ga92150a1d7898e89e46c6fbac95ea60d3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_RSTCAUSE</b>&#160;&#160;&#160;(IEC60730_RST-&gt;RSTCAUSE)</td></tr>
<tr class="separator:ga92150a1d7898e89e46c6fbac95ea60d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8ba34180217fabead2366456c8cc3c5a"><td class="memItemLeft" align="right" valign="top"><a id="ga8ba34180217fabead2366456c8cc3c5a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_RST_POR</b>&#160;&#160;&#160;(IEC60730_RSTCAUSE &amp; IEC60730_RSTCAUSE_POR)</td></tr>
<tr class="separator:ga8ba34180217fabead2366456c8cc3c5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae48d8787c42e5373647f514498fd8dcb"><td class="memItemLeft" align="right" valign="top"><a id="gae48d8787c42e5373647f514498fd8dcb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_RST_EM4</b>&#160;&#160;&#160;(IEC60730_RSTCAUSE &amp; IEC60730_RSTCAUSE_EM4)</td></tr>
<tr class="separator:gae48d8787c42e5373647f514498fd8dcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac31e34238959697aefbcb2389e518e78"><td class="memItemLeft" align="right" valign="top"><a id="gac31e34238959697aefbcb2389e518e78"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_RST_WDOG0</b>&#160;&#160;&#160;(IEC60730_RSTCAUSE &amp; IEC60730_RSTCAUSE_WDOG0)</td></tr>
<tr class="separator:gac31e34238959697aefbcb2389e518e78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga968d6276f9774a66486f8a6cbc45f253"><td class="memItemLeft" align="right" valign="top"><a id="ga968d6276f9774a66486f8a6cbc45f253"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_RST_WDOG1</b>&#160;&#160;&#160;0</td></tr>
<tr class="separator:ga968d6276f9774a66486f8a6cbc45f253"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac3f28393a22578f3b9e9f0670d66893f"><td class="memItemLeft" align="right" valign="top"><a id="gac3f28393a22578f3b9e9f0670d66893f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_RST_WDOGS</b>&#160;&#160;&#160;(IEC60730_RST_WDOG0 || IEC60730_RST_WDOG1)</td></tr>
<tr class="separator:gac3f28393a22578f3b9e9f0670d66893f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3e5e331377099a0d61fc7cb59489f0a2"><td class="memItemLeft" align="right" valign="top"><a id="ga3e5e331377099a0d61fc7cb59489f0a2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_RST_WDOG</b>(numb)&#160;&#160;&#160;(IEC60730_RSTCAUSE &amp; iec60730_WdogInst_arr[numb].rst)</td></tr>
<tr class="separator:ga3e5e331377099a0d61fc7cb59489f0a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0f162047bde162a448f2c2cb53fa6117"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_RST_WDOG_CHECK</b>(numb)</td></tr>
<tr class="separator:ga0f162047bde162a448f2c2cb53fa6117"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1172d14dbbd61b86561a8d0445d4322b"><td class="memItemLeft" align="right" valign="top"><a id="ga1172d14dbbd61b86561a8d0445d4322b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_WDOG_CONFIG</b>(n)&#160;&#160;&#160;{.wdog = IEC60730_WDOG_INST(n), .rst = IEC60730_RSTCAUSE_WDOG##n},</td></tr>
<tr class="separator:ga1172d14dbbd61b86561a8d0445d4322b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4be38043aebb9ffcee5a25cd980fa0e9"><td class="memItemLeft" align="right" valign="top"><a id="ga4be38043aebb9ffcee5a25cd980fa0e9"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_CFG_WDOG0</b>&#160;&#160;&#160;IEC60730_WDOG_CONFIG(0)</td></tr>
<tr class="separator:ga4be38043aebb9ffcee5a25cd980fa0e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1ff58a079a084c32cee8be18e9a7b77e"><td class="memItemLeft" align="right" valign="top"><a id="ga1ff58a079a084c32cee8be18e9a7b77e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_CFG_WDOG1</b></td></tr>
<tr class="separator:ga1ff58a079a084c32cee8be18e9a7b77e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadb3cfdfd90dcaa39d50a02bb19caafbe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_WDOG_CFGSET</b></td></tr>
<tr class="separator:gadb3cfdfd90dcaa39d50a02bb19caafbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabb0678e1cb79faa661c9ccbfd9d603e0"><td class="memItemLeft" align="right" valign="top"><a id="gabb0678e1cb79faa661c9ccbfd9d603e0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_WDOG_EN_WAIT_DISABLING</b>(numb)</td></tr>
<tr class="separator:gabb0678e1cb79faa661c9ccbfd9d603e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaacdebb75a788e9e389c6f4497f20a513"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_SETWATCHDOGTIMEOUTMIN</b>(numb)</td></tr>
<tr class="separator:gaacdebb75a788e9e389c6f4497f20a513"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9cae29f9fe13844b6efdb8bd63ae33b4"><td class="memItemLeft" align="right" valign="top"><a id="ga9cae29f9fe13844b6efdb8bd63ae33b4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_BURAM</b>&#160;&#160;&#160;BURAM</td></tr>
<tr class="separator:ga9cae29f9fe13844b6efdb8bd63ae33b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabd79c5f7254a4fb17f988abf353c0625"><td class="memItemLeft" align="right" valign="top"><a id="gabd79c5f7254a4fb17f988abf353c0625"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_BURAM_IDX</b>&#160;&#160;&#160;0UL</td></tr>
<tr class="separator:gabd79c5f7254a4fb17f988abf353c0625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga733d6005ddf1f92d9af6be12bf34431e"><td class="memItemLeft" align="right" valign="top"><a id="ga733d6005ddf1f92d9af6be12bf34431e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_BURAM_STATE_SHIFT</b>&#160;&#160;&#160;8UL</td></tr>
<tr class="separator:ga733d6005ddf1f92d9af6be12bf34431e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab1065c269517ba77a98d80d6acc86684"><td class="memItemLeft" align="right" valign="top"><a id="gab1065c269517ba77a98d80d6acc86684"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IEC60730_BURAM_MASK</b>&#160;&#160;&#160;0xFFUL</td></tr>
<tr class="separator:gab1065c269517ba77a98d80d6acc86684"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:gaece8bdb434f4c8bafba3590467815044"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__WDOG__Test.html#gaece8bdb434f4c8bafba3590467815044">iec60730_TestWatchdog_t</a> { <a class="el" href="group__IEC60730__WDOG__Test.html#ggaece8bdb434f4c8bafba3590467815044a3dbff590e48b57859ec08cfff6c6812b">iec60730_WatchdogInvalid</a> = 0, 
<a class="el" href="group__IEC60730__WDOG__Test.html#ggaece8bdb434f4c8bafba3590467815044a5d9a9cd963dc0a0bbccd807d674bffe9">iec60730_WatchdogTesting</a> = 1, 
<a class="el" href="group__IEC60730__WDOG__Test.html#ggaece8bdb434f4c8bafba3590467815044a7f643e2fc022bee4149c82ec9c42f3ef">iec60730_WatchdogValid</a> = 2
 }</td></tr>
<tr class="memdesc:gaece8bdb434f4c8bafba3590467815044"><td class="mdescLeft">&#160;</td><td class="mdescRight">State of watchdog testing.  <a href="group__IEC60730__WDOG__Test.html#gaece8bdb434f4c8bafba3590467815044">More...</a><br /></td></tr>
<tr class="separator:gaece8bdb434f4c8bafba3590467815044"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga8b7e7389eabf5b9497b094c9ebe1778d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__WDOG__Test.html#ga8b7e7389eabf5b9497b094c9ebe1778d">iec60730_RestartWatchdogs</a> (void)</td></tr>
<tr class="separator:ga8b7e7389eabf5b9497b094c9ebe1778d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3d1902e82797eef6780ffcd8cd4a1f0e"><td class="memItemLeft" align="right" valign="top">volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__WDOG__Test.html#ga3d1902e82797eef6780ffcd8cd4a1f0e">SI_SEGMENT_VARIABLE</a> (iec60730_WatchdogState, <a class="el" href="group__IEC60730__WDOG__Test.html#gaece8bdb434f4c8bafba3590467815044">iec60730_TestWatchdog_t</a>, SI_SEG_DATA_RETAINED_NO_CLEAR)</td></tr>
<tr class="separator:ga3d1902e82797eef6780ffcd8cd4a1f0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga558fac53c0d96b6b1ae215ceadc335dc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741">iec60730_TestResult_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IEC60730__WDOG__Test.html#ga558fac53c0d96b6b1ae215ceadc335dc">iec60730_WatchdogPost</a> (void)</td></tr>
<tr class="separator:ga558fac53c0d96b6b1ae215ceadc335dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Monitors CPU execution. </p>
<p>For IEC 60730, a watchdog timer must be enabled to validate proper operation of the Program Counter. A watchdog timer resets the device if it has not been restarted. </p>
<h1><a class="anchor" id="watchdog_hardware_architecture"></a>
Hardware Architecture</h1>
<p>The second implementation has a dedicated watchdog peripheral WDOG0, WDOG1 watchdog timers in the EFR32 family.</p>
<dl class="section warning"><dt>Warning</dt><dd>- The watchdog timer must be disabled during flash page erase.</dd></dl>
<h1><a class="anchor" id="watchdog_failure_risks"></a>
Failure Risks</h1>
<p>The watchdog timer will force entry into Safe State if the firmware program execution does not return to the BIST quick enough. This will detect a failure that causes the CPU to halt or enter an infinite loop. The watchdog timer POST verifies that a watchdog timer reset is possible.</p>
<p>OEMs must ensure that their system works reliably in all modes of operation using the watchdog timeout. Insufficient testing may allow for firmware states that inadvertently trigger a watchdog reset.</p>
<h1><a class="anchor" id="watchdog_software_architecture"></a>
Software Architecture</h1>
<p>For the EFR32 IEC60730 implementation, <a class="el" href="group__IEC60730__WDOG__Test.html#watchdog_flowchart">Figure 1</a> shows the logic flow chart of the Watchdog Timer during POST. The POST test determines if the reset source was a power-on, and if so, validates that a watchdog reset can occur. If the reset source was a watchdog reset, it determines if the watchdog reset was expected as part of POST testing, or unexpected. An unexpected reset causes immediate <a class="el" href="group__IEC60730__SAFE__STATE.html#gaf28ccd1df36222150296fbfe62ace9cf">iec60730_SafeState()</a> entry. Otherwise normal operation continues.</p>
<div class="image">
<img src="Watchdog_flowchart.png" alt=""/>
<div class="caption">
Figure 1 Flow chart of Watchdog Timer POST validation</div></div>
<p><a class="anchor" id="watchdog_flowchart"></a> The main loop must execute <a class="el" href="group__IEC60730__BIST.html#ga2e25e3bbfafc3679a262b9834dc08c0c">iec60730_Bist()</a> faster than the nominal timeout, or call <a class="el" href="group__IEC60730__WDOG__Test.html#ga8b7e7389eabf5b9497b094c9ebe1778d">iec60730_RestartWatchdogs()</a>. After <a class="el" href="group__IEC60730__BIST.html#ga2e25e3bbfafc3679a262b9834dc08c0c">iec60730_Bist()</a> has confirmed all modules are operating correctly it restarts the Watchdog Timer with <a class="el" href="group__IEC60730__WDOG__Test.html#ga8b7e7389eabf5b9497b094c9ebe1778d">iec60730_RestartWatchdogs()</a>. If a module is not operating correctly, <a class="el" href="group__IEC60730__BIST.html#ga2e25e3bbfafc3679a262b9834dc08c0c">iec60730_Bist()</a> calls <a class="el" href="group__IEC60730__SAFE__STATE.html#gaf28ccd1df36222150296fbfe62ace9cf">iec60730_SafeState()</a>. <a class="el" href="group__IEC60730__SAFE__STATE.html#gaf28ccd1df36222150296fbfe62ace9cf">iec60730_SafeState()</a> will call <a class="el" href="group__IEC60730__WDOG__Test.html#ga8b7e7389eabf5b9497b094c9ebe1778d">iec60730_RestartWatchdogs()</a> continuously. The system must be powered down and restarted to resume normal operation.</p>
<p>The function iec60730_WatchdogPost will set the timeout period (PERSEL) to minimum when check watchdog units to avoid wasting time.</p>
<h1><a class="anchor" id="watchdog_configuration"></a>
Software Configuration</h1>
<p>The number of Watchdog units which are tested by lib should be defined by user code by defining the macros "IEC60730_WDOGINST_NUMB" and IEC60730_ENABLE_WDOGx (x = 0, 1). The number of Watchdog unit depends on target EFR32 series. Example for series 1: #define IEC60730_WDOGINST_NUMB 1 #define IEC60730_ENABLE_WDOG0</p>
<p>User can define macro IEC60730_WDOG_INST(n) to select appropriate Watchdog peripheral. User can define macro IEC60730_RST to select appropriate Reset peripheral.</p>
<p>If these macros are not defined then the default configuration will be used.</p>
<p>To clear reset cause flags in the RSTCASUES register after watchdog testing completed -&gt; Add the definition of macro "#define IEC60730_RSTCAUSES_CLEAR_ENABLE" to user code. By default this feature is disabled.</p>
<p>If the Watchdog module is build in non-secure mode then the macro "IEC60730_NON_SECURE_EN" must be defined to enable the lib using non-secure address of the Watchdog peripheral.</p>
<dl class="section warning"><dt>Warning</dt><dd>- The static variable iec60730_WatchdogCount must be located at memory location that is not cleared when system startup (section ".ram_no_clear").<ul>
<li>The global variable iec60730_WatchdogState must be located at memory location that is not cleared when system startup. And it should be located at retention RAM block that is available on EFR32 Series 1 devices (section ".ram_ret_no_clear"). This will avoid the missing contain of the variable when device returns from the power saving mode EM4.</li>
</ul>
</dd></dl>
<p>There's no retention RAM on EFR32 Series 2 devices but they have backup RAM (BURAM) that could be used to save value of the variable. To enable saving iec60730_WatchdogState to backup RAM on Series 2, add the macro "#define IEC60730_SAVE_STAGE_ENABLE" to user code. By default it will be disabled. Define macro "IEC60730_BURAM_IDX" to select which register of the BURAM will be used. The default value is 0x0. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga0f162047bde162a448f2c2cb53fa6117"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0f162047bde162a448f2c2cb53fa6117">&#9670;&nbsp;</a></span>IEC60730_RST_WDOG_CHECK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IEC60730_RST_WDOG_CHECK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">numb</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  (IEC60730_RSTCAUSE &amp; iec60730_WdogInst_arr[numb].rst)                        \</div>
<div class="line">      == iec60730_WdogInst_arr[numb].rst</div>
</div><!-- fragment -->
</div>
</div>
<a id="gad156ac33ab4d946d158f7faafff358e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad156ac33ab4d946d158f7faafff358e8">&#9670;&nbsp;</a></span>IEC60730_RSTCAUSES_CLEAR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IEC60730_RSTCAUSES_CLEAR</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <span class="keywordflow">do</span> {                                                                         \</div>
<div class="line">    IEC60730_RST-&gt;CMD |= RMU_CMD_RCCLR;                                        \</div>
<div class="line">  } <span class="keywordflow">while</span> (0)</div>
</div><!-- fragment -->
</div>
</div>
<a id="gaacdebb75a788e9e389c6f4497f20a513"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaacdebb75a788e9e389c6f4497f20a513">&#9670;&nbsp;</a></span>IEC60730_SETWATCHDOGTIMEOUTMIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IEC60730_SETWATCHDOGTIMEOUTMIN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">numb</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <span class="keywordflow">do</span> {                                                                         \</div>
<div class="line">    while ((iec60730_WdogInst_arr[numb].wdog-&gt;SYNCBUSY &amp; WDOG_SYNCBUSY_CTRL)   \</div>
<div class="line">           != 0U) {}                                                           \</div>
<div class="line">    iec60730_WdogInst_arr[numb].wdog-&gt;CTRL &amp;=                                  \</div>
<div class="line">        ~(uint32_t) _WDOG_CTRL_PERSEL_MASK;                                    \</div>
<div class="line">  } <span class="keywordflow">while</span> (0)</div>
</div><!-- fragment -->
</div>
</div>
<a id="gadb3cfdfd90dcaa39d50a02bb19caafbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadb3cfdfd90dcaa39d50a02bb19caafbe">&#9670;&nbsp;</a></span>IEC60730_WDOG_CFGSET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IEC60730_WDOG_CFGSET</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  IEC60730_CFG_WDOG0                                                           \</div>
<div class="line">  IEC60730_CFG_WDOG1</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga9b9ea237b837cef20891f8dca51c3735"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9b9ea237b837cef20891f8dca51c3735">&#9670;&nbsp;</a></span>WDG_INST_DEF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WDG_INST_DEF</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <span class="keyword">const</span> <a class="code" href="structiec60730__WatchDog__t.html">iec60730_WatchDog_t</a> iec60730_WdogInst_arr[IEC60730_WDOGINST_NUMB] = {  \</div>
<div class="line">      IEC60730_WDOG_CFGSET}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="gaece8bdb434f4c8bafba3590467815044"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaece8bdb434f4c8bafba3590467815044">&#9670;&nbsp;</a></span>iec60730_TestWatchdog_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__IEC60730__WDOG__Test.html#gaece8bdb434f4c8bafba3590467815044">iec60730_TestWatchdog_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>State of watchdog testing. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ggaece8bdb434f4c8bafba3590467815044a3dbff590e48b57859ec08cfff6c6812b"></a>iec60730_WatchdogInvalid&#160;</td><td class="fielddoc"><p>Watchdog POST test not done. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggaece8bdb434f4c8bafba3590467815044a5d9a9cd963dc0a0bbccd807d674bffe9"></a>iec60730_WatchdogTesting&#160;</td><td class="fielddoc"><p>Watchdog POST testing in progress. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggaece8bdb434f4c8bafba3590467815044a7f643e2fc022bee4149c82ec9c42f3ef"></a>iec60730_WatchdogValid&#160;</td><td class="fielddoc"><p>Watchdog POST test complete, watchdog valid. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga8b7e7389eabf5b9497b094c9ebe1778d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8b7e7389eabf5b9497b094c9ebe1778d">&#9670;&nbsp;</a></span>iec60730_RestartWatchdogs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iec60730_RestartWatchdogs </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>public IEC60730 Watchdog Restart</p>
<dl class="section return"><dt>Returns</dt><dd>None.</dd></dl>
<p>This function abstracts the differences between the EFR32 family watchdog timers. OEMs can call it during long duration executions to restart the watchdog timer. </p>

</div>
</div>
<a id="ga558fac53c0d96b6b1ae215ceadc335dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga558fac53c0d96b6b1ae215ceadc335dc">&#9670;&nbsp;</a></span>iec60730_WatchdogPost()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741">iec60730_TestResult_t</a> iec60730_WatchdogPost </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>public IEC60730 Watchdog Power On Self Test</p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__IEC60730__POST.html#ga15a78a582ee2ef5999615f3a64d26741" title="The result of a test.">iec60730_TestResult_t</a> If a non-watchdog reset occurred, test watchdog (will not return). Otherwise determine if watchdog reset was planned or unplanned. Unplanned watchdog resets result in failure and entry to Safe State. Planned watchdog resets return <a class="el" href="group__IEC60730__POST.html#gga15a78a582ee2ef5999615f3a64d26741a6796830621fbae14b5c78b4a36af1b84" title="test result passed">iec60730_TestPassed</a>.</dd></dl>
<p>This function will test the watchdog timer by forcing a watchdog reset on the first power-up. Any subsequent watchdog reset forces entry into <a class="el" href="group__IEC60730__SAFE__STATE.html#gaf28ccd1df36222150296fbfe62ace9cf">iec60730_SafeState()</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>Remove all accesses to Watchdog Timer hardware from InitDevice. Reset state of pins must be safe for the device. During POST test, device pins will be kept in reset state while validating watchdog reset. </dd></dl>

</div>
</div>
<a id="ga3d1902e82797eef6780ffcd8cd4a1f0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3d1902e82797eef6780ffcd8cd4a1f0e">&#9670;&nbsp;</a></span>SI_SEGMENT_VARIABLE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile SI_SEGMENT_VARIABLE </td>
          <td>(</td>
          <td class="paramtype">iec60730_WatchdogState&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__IEC60730__WDOG__Test.html#gaece8bdb434f4c8bafba3590467815044">iec60730_TestWatchdog_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SI_SEG_DATA_RETAINED_NO_CLEAR&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Global variable used to track watchdog testing state.</p>
<dl class="section warning"><dt>Warning</dt><dd>Must be placed in a memory area not cleared to 0x0 on start! </dd></dl>

</div>
</div>
</div><!-- contents -->
<div class="ttc" id="astructiec60730__WatchDog__t_html"><div class="ttname"><a href="structiec60730__WatchDog__t.html">iec60730_WatchDog_t</a></div><div class="ttdoc">Watchdog component configuration structure.</div><div class="ttdef"><b>Definition:</b> sl_iec60730_watchdog.h:111</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
